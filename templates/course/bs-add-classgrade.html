{% extends 'bs-base.html' %}


{% block title %}
    添加开课班级
{% endblock %}


{% block content %}
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="{% url 'courses:course-list' %}">课程</a></li>
          <li class="breadcrumb-item"><a href="{{ course.get_absolute_url }}">{{ course }}</a></li>
          <li class="breadcrumb-item active" aria-current="page">添加开课班级</li>
      </ol>
    </nav>
    <div class="card border-0">
        <div class="card-body pt-0">
            <div class="card-text">
                <div class="form-group">
                    <label for="classgrade-title" class="col-form-label">班级名</label>
                    <input class="form-control" id="classgrade-title">
                </div>
                <div class="form-group">
                    <label for="classgrade-title" class="col-form-label">邀请码</label>
                    <input class="form-control" id="classgrade-code" placeholder="用于订阅班级">
                </div>
            </div>
{#            <a href="http://www.markdown.cn/" target="_blank" class="card-link">概述支持Markdown语法</a>#}
            <button data-cid="{{ course.id }}"
                    class="card-link btn btn-outline-success float-right add-classgrade">
                <i class="fa fa-paper-plane-o" aria-hidden="true"></i> 提交
            </button>
        </div>
    </div>
{% endblock %}


{% block js %}
    <script type="text/javascript">
        $('button.add-classgrade').click(function () {
            var title = $.trim($('input#classgrade-title').val());
            var code = $.trim($('input#classgrade-code').val());
            var cid = $(this).data('cid');
            if (title == '' || code == ''){
                tips('班级名、邀请码都不能为空', 'danger');
                return false;
            }
            $.ajax({
                cache: false,
                type: 'POST',
                url: '/course/add/class/',
                data: {'cid': cid, 'title': title, 'code': code},
                async: true,
                success: function (data) {
                    if (data.msg == 'ok'){
                        tips('提交成功~', 'success');
                        setTimeout(function () {
                            location.reload();
                        }, 1500);
                        return true;
                    }else {
                        tips('哎呀，提交失败了~，请再试一次吧');
                        setTimeout(function () {
                            location.reload();
                        }, 1500);
                        return true;
                    }
                }
            });
        });
    </script>
{% endblock %}